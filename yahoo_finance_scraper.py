from bs4 import BeautifulSoup
import requests
import csv
from yahoo_finance import Share

# this will probably take like 2 hours to run and then still have some index_errors
# should have it retry index error instead of just moving on
# why won't it ctrl c?
# ctrl shift \ works
# just view page source to get split keys
# definitely should've taken more basic data from the api. bym, for example, is a 1 but seems like a long-term hold.
# also consider may not want to watch this every day over the summer
# actually seems like maybe bym bugs to 1 because no data? https://finance.yahoo.com/quote/BYM/analysts?p=BYM
# remember that selling an individual stock at a loss may be good for tax efficiency
# read about stock picking and tax efficiency
# maybe be more aggressive, put morre money in robin hood if it beats indexes
# replace crd.a with crd-a. its a strong buy

# looks like sectors are basic materials, conglomerates, consumer goods,
# financial, healthcare, industrial goods, services, technology, utilities
# avg price is 30 so you could get like 30 different stocks, 5 per category
# weight sectors intelligently though. why not take thirty 1's
# there are eighty 1's
# 1 is strong buy
# 2 is buy
# 3 is hold
# ditching everything at 3 or above or no data or error cuts the space in half
# I'm just gonna ditch everything above 2
# down to 600 stocks



# wtf the list is fucked. no goog, no msft...
# downloaded on may 5 2017 from http://www.eoddata.com/symbols.aspx
ticker_list = ['A','AA','AAC','AAN','AAP','AAT','AAV','AB','ABB','ABBV','ABC','ABEV','ABG','ABM','ABR','ABR-A','ABR-B','ABR-C','ABRN','ABT','ABX','AC','ACC','ACCO','ACH','ACM','ACN','ACP','ACRE','ACV','ADC','ADM','ADNT','ADPT','ADS','ADSW','ADX','AEB','AED','AEE','AEG','AEH','AEK','AEL','AEM','AEO','AEP','AER','AES','AES-C','AET','AEUA','AF','AF-C','AFA','AFB','AFC','AFG','AFGE','AFGH','AFI','AFL','AFS-A','AFS-B','AFS-C','AFS-D','AFS-E','AFS-F','AFSD','AFSS','AFST','AFT','AFW','AG','AGC','AGCO','AGD','AGI','AGM','AGM-A','AGM-B','AGM-C','AGM.A','AGN','AGN-A','AGO','AGO-B','AGO-E','AGO-F','AGR','AGRO','AGU','AGX','AHC','AHH','AHL','AHL-B','AHL-C','AHL-D','AHP','AHP-B','AHT','AHT-A','AHT-D','AHT-F','AHT-G','AI','AIB','AIC','AIF','AIG','AIG.W','AIN','AIR','AIT','AIV','AIV-A','AIW','AIY','AIZ','AJG','AJRD','AJX','AJXA','AKO.A','AKO.B','AKP','AKR','AKS','AL','ALB','ALDW','ALE','ALEX','ALG','ALJ','ALK','ALL','ALL-A','ALL-B','ALL-C','ALL-D','ALL-E','ALL-F','ALL-Y','ALLE','ALLY','ALP-O','ALR','ALR-B','ALSN','ALV','ALX','AM','AMBR','AMC','AME','AMFW','AMG','AMH','AMH-A','AMH-B','AMH-C','AMH-D','AMH-E','AMH-F','AMID','AMN','AMOV','AMP','AMRC','AMT','AMT-A','AMT-B','AMX','AN','ANET','ANF','ANFI','ANH','ANH-A','ANH-B','ANH-C','ANTM','ANTX','ANW','AOD','AOI','AON','AOS','AP','APA','APAM','APB','APC','APD','APF','APFH','APH','APLE','APO','APO-A','APTS','APU','AQN','AR','ARA','ARC','ARCH','ARCO','ARCX','ARD','ARDC','ARE','ARE-A','ARE-D','ARE-E','ARES','ARH-C','ARI','ARI-A','ARI-C','ARL','ARMK','ARN-B','ARNC','AROC','ARR','ARR-A','ARR-B','ARU','ARW','ASA','ASB','ASB-C','ASB-D','ASC','ASG','ASGN','ASH','ASIX','ASPN','ASR','ASX','AT','ATEN','ATH','ATHM','ATI','ATKR','ATO','ATR','ATTO','ATU','ATV','ATW','AU','AUO','AUY','AVA','AVAL','AVB','AVD','AVH','AVK','AVP','AVT','AVX','AVY','AWF','AWH','AWI','AWK','AWP','AWR','AXE','AXL','AXON','AXP','AXR','AXS','AXS-C','AXS-D','AXS-E','AXTA','AYI','AYR','AYX','AZN','AZO','AZRE','AZUL','AZZ','B','BA','BABA','BAC','BAC-A','BAC-C','BAC-D','BAC-E','BAC-I','BAC-L','BAC-W','BAC-Y','BAC.A','BAC.B','BAF','BAH','BAK','BAM','BAN-C','BAN-D','BAN-E','BANC','BAP','BAS','BAX','BBD','BBDO','BBF','BBG','BBK','BBL','BBN','BBT','BBT-D','BBT-E','BBT-F','BBT-G','BBT-H','BBU','BBVA','BBW','BBY','BC','BCC','BCE','BCEI','BCH','BCO','BCR','BCRH','BCS','BCS-D','BCX','BDC','BDC-B','BDJ','BDN','BDN-E','BDX','BEL','BEN','BEP','BERY','BETR','BF.A','BF.B','BFAM','BFK','BFO','BFR','BFS','BFS-C','BFZ','BG','BGB','BGC','BGCA','BGE-B','BGG','BGH','BGIO','BGR','BGS','BGT','BGX','BGY','BH','BHE','BHI','BHK','BHL','BHLB','BHP','BID','BIF','BIG','BIO','BIO.B','BIO.W','BIOA','BIP','BIT','BITA','BJZ','BK','BK-C','BKD','BKE','BKFS','BKH','BKHU','BKK','BKN','BKS','BKT','BKU','BLD','BLH','BLK','BLL','BLW','BLX','BMA','BME','BMI','BML-G','BML-H','BML-I','BML-J','BML-L','BMO','BMS','BMY','BNED','BNJ','BNS','BNY','BOE','BOH','BOOT','BORN','BOX','BOXC','BP','BPI','BPK','BPL','BPT','BPY','BQH','BR','BRC','BRFS','BRK.A','BRK.B','BRO','BRS','BRSS','BRT','BRX','BSAC','BSBR','BSD','BSE','BSL','BSM','BSMX','BST','BSX','BT','BTA','BTE','BTO','BTT','BTU','BTZ','BUD','BUI','BURL','BVN','BW','BWA','BWG','BWP','BWXT','BX','BXC','BXE','BXMT','BXMX','BXP','BXP-B','BXS','BYD','BYM','BZH','C','C-C','C-J','C-K','C-L','C-N','C-P','C-S','C.A','CAA','CAB','CABO','CACI','CADE','CAE','CAF','CAG','CAH','CAI','CAJ','CAL','CALX','CAPL','CAT','CATO','CB','CBA','CBB','CBB-B','CBD','CBG','CBI','CBK','CBL','CBL-D','CBL-E','CBM','CBPX','CBR','CBS','CBS.A','CBT','CBU','CBZ','CC','CCC','CCE','CCI','CCJ','CCK','CCL','CCM','CCO','CCP','CCS','CCU','CCV','CCZ','CDE','CDI','CDR','CDR-B','CE','CEA','CEE','CEL','CELP','CEM','CEN','CEO','CEQP','CF','CFC-B','CFG','CFI','CFR','CFR-A','CFX','CGA','CGG','CGI','CHA','CHCT','CHD','CHE','CHGG','CHH','CHK','CHK-D','CHKR','CHL','CHMI','CHMT','CHN','CHS','CHS-A','CHSP','CHT','CHU','CI','CIA','CIB','CIE','CIEN','CIF','CIG','CIG.C','CII','CIM','CIM-A','CIM-B','CINR','CIO','CIO-A','CIR','CIT','CIVI','CJ','CKH','CL','CLA','CLB','CLD','CLDR','CLDT','CLF','CLGX','CLH','CLI','CLN-A','CLN-B','CLN-C','CLN-D','CLN-E','CLN-F','CLN-G','CLN-H','CLNS','CLPR','CLR','CLS','CLW','CLX','CM','CMA','CMA.W','CMC','CMCM','CMD','CMG','CMI','CMO','CMO-E','CMP','CMR-B','CMR-C','CMR-D','CMRE','CMS','CMS-B','CMU','CNA','CNC','CNCO','CNDT','CNHI','CNI','CNK','CNNX','CNO','CNP','CNQ','CNS','CNX','CNXC','CO','CODI','COE','COF','COF-C','COF-D','COF-F','COF-G','COF-H','COF-P','COF.W','COG','COH','COL','COO','COP','COR','COR-A','COR-Z','CORR','COT','COTV','COTY','CP','CPA','CPAC','CPB','CPE','CPE-A','CPF','CPG','CPK','CPL','CPN','CPS','CPT','CR','CRC','CRCM','CRD.A','CRD.B','CRH','CRI','CRK','CRL','CRM','CRR','CRS','CRT','CRY','CS','CSL','CSLT','CSRA','CSS','CST','CSTM','CSU','CSV','CTAA','CTB','CTBB','CTDD','CTL','CTLT','CTR','CTS','CTT','CTU','CTV','CTW','CTX','CTY','CTZ','CUB','CUB-C','CUB-D','CUB-E','CUB-F','CUBE','CUBI','CUBS','CUDA','CUK','CUZ','CVA','CVE','CVEO','CVG','CVI','CVNA','CVO','CVRR','CVS','CVX','CW','CWEI','CWH','CWT','CX','CXE','CXH','CXO','CXP','CXW','CYD','CYH','CYS','CYS-A','CYS-B','CZZ','D','DAC','DAL','DAN','DAR','DATA','DB','DBD','DBL','DCI','DCM','DCO','DCP','DCT','DCUC','DCUD','DD','DD-A','DD-B','DDC','DDD','DDE','DDF','DDR','DDR-J','DDR-K','DDS','DDT','DE','DEA','DECK','DEI','DEL','DEO','DEX','DF','DFIN','DFP','DFS','DFS-B','DFT','DFT-C','DG','DGI','DGX','DHF','DHG','DHI','DHR','DHT','DHX','DIAX','DIN','DIS','DK','DKL','DKS','DKT','DL','DLB','DLN-A','DLNG','DLPH','DLR','DLR-G','DLR-H','DLR-I','DLX','DM','DMB','DMO','DNB','DNI','DNOW','DNP','DNR','DO','DOC','DOOR','DOV','DOW','DPG','DPLO','DPS','DPZ','DQ','DRA','DRD','DRE','DRH','DRI','DRQ','DRUA','DS','DS-B','DS-C','DS-D','DSE','DSL','DSM','DST','DSU','DSW','DSX','DSX-B','DSXN','DTE','DTF','DTJ','DTK','DTL.P','DTQ','DTV','DTY','DUC','DUK','DUKH','DV','DVA','DVD','DVMT','DVN','DX','DX-A','DX-B','DXB','DXC','DY','DYN','DYN-A','DYN.A','DYN.W','DYNC','E','EAB','EAE','EAI','EARN','EAT','EBF','EBR','EBR.B','EBS','EC','ECA','ECC','ECCA','ECCB','ECCZ','ECL','ECOM','ECR','ECT','ED','EDD','EDF','EDI','EDN','EDR','EDU','EE','EEA','EEP','EEQ','EEX','EFC','EFF','EFR','EFT','EFX','EGF','EGIF','EGL','EGN','EGO','EGP','EGY','EHI','EHIC','EHT','EIG','EIX','EL','ELC','ELF','ELJ','ELLI','ELP','ELS','ELS-C','ELU','ELVT','ELY','EMD','EME','EMES','EMF','EMN','EMO','EMP','EMR','ENB','ENBL','ENH-C','ENIA','ENIC','ENJ','ENLC','ENLK','ENO','ENR','ENS','ENV','ENVA','ENZ','EOCC','EOD','EOG','EOI','EOS','EOT','EP-C','EPAM','EPC','EPD','EPE','EPR','EPR-C','EPR-E','EPR-F','EQC','EQC-D','EQCO','EQGP','EQM','EQR','EQS','EQT','ERA','ERF','ERJ','EROS','ES','ESE','ESL','ESNT','ESRT','ESS','ESV','ETB','ETE','ETG','ETH','ETJ','ETM','ETN','ETO','ETP','ETR','ETV','ETW','ETX','ETY','EURN','EV','EVA','EVC','EVE-A','EVER','EVF','EVG','EVH','EVH.P','EVHC','EVN','EVR','EVRI','EVT','EVTC','EW','EXAR','EXC','EXCU','EXD','EXG','EXK','EXP','EXPR','EXR','EXTN','EZT','F','FAC','FAF','FAM','FBC','FBHS','FBK','FBM','FBP','FBR','FC','FCAU','FCB','FCE.A','FCE.B','FCF','FCFS','FCH','FCH-A','FCN','FCPT','FCT','FCX','FDC','FDEU','FDP','FDS','FDX','FE','FEI','FELP','FENG','FEO','FET','FF','FFA','FFC','FFG','FGB','FGL','FGP','FHN','FHN-A','FHY','FI','FICO','FIF','FIG','FII','FIS','FIT','FIV','FIX','FL','FLC','FLO','FLOW','FLR','FLS','FLT','FLY','FMC','FMN','FMO','FMS','FMSA','FMX','FMY','FN','FNB','FNB-E','FND','FNF','FNFV','FNV','FOE','FOF','FOR','FPF','FPI','FPL','FPO','FPT','FR','FRA','FRAC','FRC','FRC-B','FRC-C','FRC-D','FRC-E','FRC-F','FRC-G','FRO','FRT','FSB','FSCE','FSD','FSIC','FSM','FSS','FT','FTAI','FTI','FTK','FTS','FTV','FUL','FUN','G','GAB','GAB-D','GAB-G','GAB-H','GAB-J','GAM','GAM-B','GATX','GBAB','GBL','GBX','GCAP','GCH','GCI','GCO','GCP','GCV','GCV-B','GD','GDDY','GDL','GDL-B','GDO','GDOT','GDV','GDV-A','GDV-D','GDV-G','GE','GEB','GEF','GEF.B','GEH','GEK','GEL','GEN','GEO','GER','GES','GF','GFA','GFF','GFI','GFY','GG','GGB','GGG','GGM','GGP','GGP-A','GGT','GGT-B','GGZ','GGZ-A','GHC','GHL','GHM','GHY','GIB','GIL','GIM','GIMO','GIS','GJH','GJO','GJP','GJR','GJS','GJT','GJV','GKOS','GLA','GLF','GLO-A','GLOB','GLOG','GLOP','GLP','GLT','GLW','GM','GM.B','GME','GMED','GMRE','GMS','GMTA','GMZ','GNC','GNE','GNE-A','GNK','GNL','GNRC','GNRT','GNT','GNW','GOF','GOL','GOLF','GOOS','GPC','GPE-A','GPI','GPK','GPM','GPN','GPRK','GPS','GPT','GPT-A','GPX','GRA','GRAM','GRP.U','GRR','GRUB','GRX','GRX-A','GRX-B','GS','GS-A','GS-B','GS-C','GS-D','GS-I','GS-J','GS-K','GS-N','GSBD','GSH','GSK','GSL','GSL-B','GTN','GTN.A','GTS','GTT','GTY','GUT','GUT-A','GUT-C','GVA','GWB','GWR','GWRE','GWW','GXP','GXP-B','GYB','GYC','GZT','H','HAE','HAL','HASI','HBI','HBM','HBM.W','HCA','HCC','HCI','HCLP','HCN','HCN-I','HCP','HD','HDB','HE','HE-U','HEI','HEI.A','HEP','HEQ','HES','HES-A','HESM','HF','HFC','HGH','HGT','HGV','HHC','HHS','HI','HIE','HIFR','HIG','HIG.W','HII','HIL','HIO','HIVE','HIW','HIX','HJV','HK','HK.W','HL','HL-B','HLF','HLI','HLS','HLT','HLX','HMC','HMLP','HMN','HMY','HNI','HNP','HNR','HOG','HOME','HON','HOS','HOV','HP','HPE','HPF','HPI','HPP','HPQ','HPS','HQH','HQL','HR','HRB','HRC','HRG','HRI','HRL','HRS','HRTG','HSB-A','HSBC','HSC','HSEA','HSEB','HST','HSY','HT','HT-C','HT-D','HT-E','HTA','HTD','HTF','HTGC','HTGX','HTH','HTY','HTZ','HUBB','HUBS','HUM','HUN','HVT','HVT.A','HW','HXL','HY','HYB','HYH','HYI','HYT','HZN','HZO','I','IAE','IAG','IBA','IBM','IBN','IBP','ICB','ICD','ICE','ICL','IDA','IDE','IDT','IEX','IFF','IFN','IGA','IGD','IGI','IGR','IGT','IHC','IHD','IHG','IHIT','IID','IIF','IIM','IIPR','IMAX','INB','INF','INFY','ING','INGR','INN','INN-B','INN-C','INN-D','INSI','INST','INSW','INT','INVH','INVN','INXN','IO','IP','IPG','IPHI','IPI','IPL-D','IQI','IR','IRE-B','IRET','IRL','IRM','IRR','IRS','ISD','ISF','ISG','ISP','IT','ITCB','ITG','ITGR','ITT','ITUB','ITW','IVC','IVH','IVR','IVR-A','IVR-B','IVZ','IX','JAG','JAX','JBK','JBL','JBN','JBR','JBT','JCAP','JCE','JCI','JCO','JCP','JDD','JE','JE-A','JEC','JELD','JEQ','JFC','JFR','JGH','JHA','JHB','JHD','JHI','JHS','JHX','JHY','JILL','JKS','JLL','JLS','JMEI','JMF','JMLP','JMM','JMP','JMPB','JMPC','JMT','JNJ','JNPR','JNS','JOE','JOF','JONE','JP','JPC','JPI','JPM','JPM-A','JPM-B','JPM-D','JPM-E','JPM-F','JPM-G','JPM-H','JPM.W','JPS','JPT','JPW','JQC','JRI','JRO','JRS','JSD','JTA','JTD','JW.A','JW.B','JWN','K','KAI','KAMN','KAP','KAR','KATE','KB','KBH','KBR','KCG','KDMN','KED','KEF','KEG','KEM','KEN','KEP','KEX','KEY','KEY-I','KEYS','KF','KFI','KFN.P','KFS','KFY','KGC','KIM','KIM-I','KIM-J','KIM-K','KIO','KKR','KKR-A','KKR-B','KMB','KMF','KMG','KMI','KMI-A','KMI.W','KMM','KMPA','KMPR','KMT','KMX','KN','KND','KNL','KNOP','KNX','KO','KOD.W','KOD.X','KODK','KOF','KOP','KORS','KOS','KR','KRA','KRC','KRC-H','KRG','KRO','KRP','KS','KSM','KSS','KST','KSU','KSU.P','KT','KTF','KTH','KTN','KTP','KW','KWN','KWR','KYE','KYN','KYN-F','KYO','L','LAD','LADR','LAZ','LB','LBF','LC','LCI','LCII','LCM','LDF','LDL','LDOS','LDP','LDR','LEA','LEE','LEG','LEJU','LEN','LEN.B','LEO','LFC','LFGR','LFL','LGF.A','LGF.B','LGI','LH','LHO','LHO-H','LHO-I','LHO-J','LII','LITB','LKSD','LL','LLL','LLY','LM','LMHA','LMHB','LMT','LN','LNC','LNC.W','LND','LNN','LNT','LOR','LOW','LPG','LPI','LPL','LPT','LPX','LQ','LRN','LSI','LTC','LUB','LUK','LUV','LUX','LVLT','LVS','LW','LXFR','LXFT','LXP','LXP-C','LXU','LYB','LYG','LYV','LZB','M','MA','MAA','MAA-I','MAC','MAIN','MAN','MANU','MAS','MATX','MAV','MBI','MBLY','MBT','MC','MCA','MCC','MCD','MCI','MCK','MCN','MCO','MCR','MCRN','MCS','MCV','MCX','MCY','MD','MDC','MDLQ','MDLX','MDLY','MDP','MDR','MDT','MDU','MED','MEI','MEN','MEP','MER-K','MER-P','MET','MET-A','MFA','MFA-B','MFC','MFCB','MFD','MFG','MFL','MFM','MFO','MFT','MFV','MG','MGA','MGF','MGM','MGP','MGR','MGU','MH-A','MH-C','MHD','MHF','MHI','MHK','MHLA','MHN','MHNB','MHNC','MHO','MHO-A','MIC','MIE','MIN','MIT-A','MIT-B','MITT','MIXT','MIY','MJN','MKC','MKC.V','MKL','MLI','MLM','MLP','MLR','MMC','MMD','MMI','MMM','MMP','MMS','MMT','MMU','MN','MNE','MNI','MNK','MNP','MNR','MNR-B','MNR-C','MO','MOD','MODN','MOG.A','MOG.B','MOH','MON','MORE','MOS','MOV','MP-D','MPA','MPC','MPLX','MPO','MPSX','MPV','MPW','MPX','MQT','MQY','MRC','MRIN','MRK','MRO','MRT','MS','MS-A','MS-E','MS-F','MS-G','MS-I','MS-K','MSA','MSB','MSCA','MSCI','MSD','MSF','MSG','MSGN','MSI','MSL','MSM','MSP','MT','MTB','MTB-C','MTB.P','MTB.W','MTD','MTDR','MTG','MTH','MTL','MTL.P','MTN','MTOR','MTR','MTRN','MTT','MTU','MTW','MTX','MTZ','MUA','MUC','MUE','MUH','MUI','MUJ','MULE','MUR','MUS','MUSA','MUX','MVC','MVCB','MVO','MVT','MWA','MX','MXE','MXF','MXL','MYC','MYCC','MYD','MYE','MYF','MYI','MYJ','MYN','MYOV','MZF','NAC','NAD','NADL','NAN','NAO','NAP','NAT','NAV','NAV-D','NAZ','NBB','NBD','NBHC','NBL','NBLX','NBR','NC','NCA','NCB','NCI','NCR','NCS','NCV','NCZ','NDP','NDRO','NE','NEA','NEE','NEE-C','NEE-G','NEE-H','NEE-I','NEE-J','NEE-K','NEE-Q','NEE-R','NEFF','NEM','NEP','NETS','NEU','NEV','NEWM','NEWR','NFG','NFJ','NFX','NGG','NGL','NGL-A','NGS','NGVC','NGVT','NHA','NHF','NHI','NI','NID','NIE','NIM','NIQ','NJR','NKE','NKG','NKX','NL','NLS','NLSN','NLY','NLY-A','NLY-C','NLY-D','NLY-E','NM','NM-G','NM-H','NMBL','NMFC','NMI','NMK-B','NMK-C','NMM','NMR','NMS','NMT','NMY','NMZ','NNA','NNC','NNI','NNN','NNN-E','NNN-F','NNY','NOA','NOAH','NOC','NOK','NOM','NOMD','NORD','NOV','NOW','NP','NPK','NPO','NPTN','NPV','NQ','NQP','NR','NRE','NRG','NRK','NRP','NRT','NRZ','NS','NS-A','NS-B','NSA','NSC','NSH','NSL','NSM','NSP','NSR','NSS','NTB','NTC','NTG','NTL','NTP','NTX','NTZ','NUE','NUM','NUO','NUS','NUV','NUW','NVG','NVGS','NVO','NVR','NVRO','NVS','NVTA','NW-C','NWE','NWHM','NWL','NWN','NWY','NX','NXC','NXJ','NXN','NXP','NXQ','NXR','NXRT','NYC-A','NYC-U','NYCB','NYL.A','NYLD','NYRT','NYT','NYV','NZF','O','OA','OAK','OAK-A','OAKS','OAS','OB','OC','OCIP','OCN','ODC','OEC','OFC','OFC-L','OFG','OFG-A','OFG-B','OFG-D','OGE','OGS','OHI','OI','OIA','OIB.C','OII','OIS','OKE','OKS','OLN','OLP','OMAA','OMAM','OMC','OME','OMF','OMI','OMN','ONDK','OOMA','OPP','OPY','OR','ORA','ORAN','ORC','ORCL','ORI','ORN','OSB','OSG','OSK','OUT','OXM','OXY','OZM','P','PAA','PAC','PACD','PAG','PAGP','PAH','PAI','PAM','PANW','PAR','PAY','PAYC','PB','PBA','PBB','PBF','PBFX','PBH','PBI','PBI-B','PBR','PBR.A','PBT','PCF','PCG','PCI','PCK','PCM','PCN','PCQ','PDI','PDM','PDS','PDT','PE','PEB','PEB-C','PEB-D','PEG','PEI','PEI-A','PEI-B','PEI-C','PEN','PEO','PEP','PER','PES','PF','PFD','PFE','PFG','PFGC','PFH','PFK','PFL','PFN','PFO','PFS','PFSI','PG','PGEM','PGH','PGP','PGR','PGRE','PGTI','PGZ','PH','PHD','PHG','PHH','PHI','PHK','PHM','PHT','PHX','PII','PIM','PIR','PIY','PJC','PJH','PJT','PK','PKD','PKE','PKG','PKI','PKO','PKX','PKY','PL-C','PL-E','PLD','PLNT','PLOW','PLT','PM','PMC','PMF','PML','PMM','PMO','PMT','PMT-A','PMX','PN','PNC','PNC-P','PNC-Q','PNC.W','PNF','PNI','PNM','PNR','PNTA','PNW','POL','POR','POST','POT','PPG','PPL','PPP','PPR','PPT','PPX','PQ','PRA','PRE-F','PRE-G','PRE-H','PRE-I','PRGO','PRH','PRI','PRLB','PRO','PRTY','PRU','PSA','PSA-A','PSA-B','PSA-C','PSA-D','PSA-E','PSA-S','PSA-T','PSA-U','PSA-V','PSA-W','PSA-X','PSA-Y','PSA-Z','PSB','PSB-T','PSB-U','PSB-V','PSB-W','PSF','PSO','PSTG','PSX','PSXP','PTHN','PTR','PTY','PUK','PUK-A','PUK.P','PUMP','PVG','PVH','PVTD','PWE','PWR','PX','PXD','PYN','PYS','PYT','PZC','PZE','PZN','Q','QCP','QEP','QHC','QSR','QTM','QTS','QTWO','QUAD','QUOT','R','RA','RACE','RAD','RAI','RAS','RAS-A','RAS-B','RAS-C','RATE','RBA','RBC','RBS','RBS-F','RBS-H','RBS-L','RBS-S','RCI','RCL','RCS','RDC','RDN','RDS.A','RDS.B','RDY','RE','REG','REG-G','RELX','REN','RENN','RENX','RES','RESI','REV','REVG','REX','REX-A','REXR','RF','RF-A','RF-B','RFI','RFP','RFT','RFTA','RGA','RGC','RGR','RGS','RGT','RH','RHI','RHP','RHT','RIC','RICE','RIG','RIO','RIV','RJF','RL','RLGY','RLH','RLI','RLJ','RM','RMAX','RMD','RMP','RMT','RNG','RNP','RNR','RNR-C','RNR-E','ROG','ROK','ROL','ROP','ROYT','RPA-A','RPAI','RPM','RPT','RPT-D','RQI','RRC','RRD','RRTS','RS','RSG','RSO','RSO-A','RSO-B','RSO-C','RSPP','RST','RT','RTEC','RTN','RUBI','RVT','RWT','RXN','RXN-A','RY','RY-S','RY-T','RYA-A','RYAM','RYI','RYN','RZA','RZB','S','SA','SAB','SAH','SAIC','SALT','SAM','SAN','SAN-A','SAN-B','SAN-C','SAN-I','SAP','SAR','SB','SB-B','SB-C','SB-D','SBBC','SBGL','SBH','SBNA','SBNB','SBR','SBS','SBY','SC','SCCO','SCD','SCE-F','SCE-G','SCE-H','SCE-J','SCE-K','SCG','SCH-B','SCH-C','SCH-D','SCHW','SCI','SCL','SCM','SCQ','SCS','SCX','SD','SDLP','SDR','SDRL','SDT','SEAS','SEE','SEM','SEMG','SEP','SERV','SF','SF-A','SFE','SFL','SFR','SFS','SFUN','SGF','SGM','SGU','SGY','SGZA','SHAK','SHG','SHI','SHLX','SHO','SHO-E','SHO-F','SHOP','SHW','SID','SIG','SITE','SIX','SJI','SJM','SJR','SJT','SJW','SKM','SKT','SKX','SLB','SLCA','SLD','SLF','SLG','SLG-I','SLRA','SLTB','SLW','SM','SMFG','SMG','SMI','SMLP','SMM','SMP','SN','SNA','SNAP','SNDR','SNE','SNN','SNOW','SNP','SNR','SNV','SNV-C','SNX','SNY','SO','SOJA','SOJB','SOL','SON','SOR','SOV-C','SPA','SPB','SPE','SPE-B','SPG','SPG-J','SPGI','SPH','SPL-A','SPLP','SPN','SPR','SPXC','SPXX','SQ','SQM','SQNS','SR','SRC','SRE','SRF','SRG','SRI','SRLP','SRT','SRV','SSD','SSI','SSL','SSNI','SSP','SSTK','SSW','SSW-D','SSW-E','SSW-G','SSW-H','SSWN','ST','STA-B','STA-C','STA-D','STA-E','STA-F','STA-G','STA-I','STAG','STAR','STAY','STC','STE','STI','STI-A','STI-E','STI.A','STI.B','STK','STL','STM','STN','STNG','STO','STON','STOR','STT','STT-C','STT-D','STT-E','STT-G','STV','STWD','STZ','STZ.B','SU','SUI','SUI-A','SUM','SUN','SUP','SUPV','SVU','SWC','SWFT','SWJ','SWK','SWM','SWN','SWNC','SWX','SWZ','SXC','SXCP','SXE','SXI','SXL','SXT','SYF','SYK','SYT','SYX','SYY','SZC','T','TAC','TAHO','TAL','TAP','TAP.A','TARO','TBI','TCAP','TCB','TCB-B','TCB-C','TCB.W','TCCA','TCCB','TCI','TCO','TCO-J','TCO-K','TCP','TCRX','TCRZ','TCS','TD','TDA','TDC','TDE','TDF','TDG','TDI','TDJ','TDOC','TDS','TDW','TDY','TECK','TEF','TEGP','TEI','TEL','TEN','TEO','TEP','TER','TEVA','TEX','TFX','TG','TGH','TGI','TGNA','TGP','TGP-A','TGS','TGT','THC','THG','THGA','THO','THQ','THR','THS','THW','TI','TI.A','TIER','TIF','TIME','TISI','TJX','TK','TKC','TKF','TKR','TLI','TLK','TLLP','TLP','TLRD','TLYS','TM','TMHC','TMK','TMK-B','TMK-C','TMO','TMST','TNC','TNET','TNH','TNK','TNP','TNP-B','TNP-C','TNP-D','TNP-E','TOL','TOO','TOO-A','TOO-B','TOT','TOWR','TPB','TPC','TPH','TPL','TPRE','TPVG','TPVZ','TPX','TPZ','TR','TRC','TRCO','TREC','TREX','TRGP','TRI','TRK','TRMR','TRN','TRN-A','TRNO','TROX','TRP','TRQ','TRR','TRTN','TRU','TRV','TS','TSE','TSI','TSLF','TSLX','TSM','TSN','TSNU','TSO','TSQ','TSS','TSU','TTC','TTF','TTI','TTM','TTP','TU','TUP','TV','TVC','TVE','TVPT','TWI','TWLO','TWN','TWO','TWO-A','TWTR','TWX','TX','TXT','TY','TY.P','TYG','TYL','UA','UAA','UAL','UAM','UAN','UBA','UBP','UBP-F','UBP-G','UBS','UCP','UDR','UE','UFI','UFS','UGI','UGP','UHS','UHT','UIS','UL','UMC','UMH','UMH-A','UMH-B','UN','UNF','UNH','UNM','UNP','UNT','UNVR','UPS','URI','USA','USAC','USB','USB-A','USB-H','USB-M','USB-N','USB-O','USDP','USFD','USG','USM','USNA','USPH','UTF','UTI','UTL','UTX','UVE','UVV','UZA','UZB','UZC','V','VAC','VAL','VAL.P','VALE','VAR','VBF','VC','VCO','VCRA','VCV','VEC','VEDL','VEEV','VER','VER-F','VET','VFC','VG','VGI','VGM','VGR','VHI','VIPS','VIV','VJET','VKQ','VLO','VLP','VLRS','VLT','VLY','VLY-A','VLY.W','VMC','VMI','VMO','VMW','VNCE','VNO','VNO-G','VNO-I','VNO-K','VNO-L','VNTV','VOC','VOYA','VPG','VPV','VR','VR-A','VRS','VRTV','VRX','VSH','VSI','VSLR','VSM','VSTO','VTA','VTN','VTR','VTRB','VTTI','VVC','VVI','VVR','VVV','VZ','VZA','W','WAAS','WAB','WAC','WAGE','WAIR','WAL','WALA','WAT','WBAI','WBC','WBK','WBS','WBS-E','WBT','WCC','WCG','WCN','WD','WDAY','WDR','WEA','WEC','WES','WEX','WF','WFC','WFC-J','WFC-L','WFC-N','WFC-O','WFC-P','WFC-Q','WFC-R','WFC-T','WFC-V','WFC-W','WFC-X','WFC-Y','WFC.W','WFE-A','WFT','WG','WGL','WGO','WGP','WHG','WHR','WIA','WIT','WIW','WK','WLH','WLK','WLKP','WLL','WM','WMB','WMC','WMK','WMLP','WMS','WMT','WNC','WNR','WNRL','WNS','WOR','WPC','WPG','WPG-H','WPG-I','WPT','WPX','WPXP','WPZ','WR','WRB','WRB-B','WRB-C','WRB-D','WRD','WRE','WRI','WRK','WSM','WSO','WSO.B','WSR','WST','WTI','WTM','WTR','WTS','WTTR','WTW','WU','WUBA','WWAV','WWE','WWW','WY','WYN','X','XCO','XEC','XEL','XHR','XIN','XKE','XL','XNY','XOM','XON','XOXO','XPO','XRF','XRM','XRX','XTLY','XYL','Y','YELP','YEXT','YGE','YPF','YRD','YUM','YUMC','YUME','ZAYO','ZB-A','ZB-F','ZB-G','ZB-H','ZBH','ZBK','ZEN','ZF','ZNH','ZOES','ZPIN','ZTO','ZTR','ZTS','ZX','ZYME']
# average recommendation 1.79
# should definitely find out how the recs are calculated
# I guess next time I can just only scrape the ones with recommmendations. speed up a bit
my_tickers = ['FB','SNY','SBUX','SPG','MU','CRM','BX']
new_tickers = ['XXII','FAX','IAF','CH','ETF','FCO','IF','ISL','LAQ','ACU','AIII','ATNM','AE','ADK-PA','ADK','ACY','WGA','AIRI','AXX','AXU','AAU','APT','AAMC','DIT','APP','ADGE','AFCO','ALN','AMS','AMPE','APHB','AXN','AMCO','HRT','AKG','AINC','AST','ATL','AWX','AVL','ASM','BTG','BTN','BKJ','BCV','MHM','DFF','BAA','BHB','BRN','ZBZX','BGSF','BPMX','BTX','BGI','BZM','MHE','BLE','MVF','MZA','BLJ','BFY','BHV','BDR','BRG','BVX','BWL-A','BZC','BTI','CANF','ROX','CVM','CEF','GTU','CET','LEU','CCF','CQH','CQP','LNG','CVR','CNR','CPHI','CKX','GLV','GLQ','GLO','CRV','MOC','CIX','LODE','CTO','MCF','CUO','CMT','CVRS','CRMD','CFP','CLM','CRF','COVR','CVU','CIK','DHY','CRVP','CTP','DAKP','DXR','VCF','VMM','VFL','DLA','DNN','DGSE','DPW','DSS','DMF','DXI','DEJ','GRF','ESTE','EVM','EIA','CEV','EVV','MAB','MMV','MIW','EMI','EIM','EIV','EMJ','EVJ','ENX','NYH','EVY','EIO','EVO','EIP','EVP','ELMD','ETAK','ELLO','ECF','EMAN','EOX','MSN','UUUU','ENRJ','ENRJ-P','ENSV','ESNC','EGI','EVI','ERB','ERN','ESP','EMXX','EVBN','EPM','XRA','FPP','FEN','FWV','BDL','FSI','FTF','FSP','FRD','FRS','GGN-PB','GGN','EGAS','GST-PA','GST','JOB','GMO','GIG','GSB','GSAT','GLOW','GORO','GSV','AUMN','GSS','GV','GRC','GTE','GPL','GRH','GRH-PC','SIM','GVP','HCHC','HEB','HLM-P','HMG','HH','HUSA','IBIO','IEC','IG','IMUC','IMH','IMO','IOT','IRT','IGC','INFU','IHT','NSPR','IFMI','IDN','INS','THM','INTT','VKI','ISR','ISDR','KIQ','KLDX','LTS','LSG','LBY','LBMH','LIQT','LEI','MCZ','MVG','MHR-PC','MJCO','MSTX','MHH','MDGN','IPB','MEA','MXC','CCA','MGT','MDW','MLSS','MGH','MGN','NNVC','NHC','NAVB','NTIP','NBW','NHS','NBH','NML','NBO','NRO','UWN','NSU','GBR','NEN','NGD','HLTH','NSAT','NAK','NOG','NBY','NCQ','NG','NTN','NVX','NZH','NCB','CFD','NXZ','NZF','NVG','CTF','NOM','NMZ','NJV','NXK','NYV','NPN','JRS','OCX','OCX-WI','OGEN','TIS','ONVO','ONP','OSGB','OSG','ORM','PHF','PBM','PCG-PA','PTN','PARR','PZG','PRK','PED','PIP','HNW','PLG','PLM','PW','PLX','PVCT','RLGT','REE','UTG','REED','RWC','RCG','RVP','RVM','RNN','RIC','REI','RIF','RBY','SGA','SSN','SPP','SAND','SARA','SEB','SVT','SIF','SVBL','SVLC','SKY','SLI','XPL','SCE-PE','SCE-PB','SGB','LOV','STRP','SSY','SDPI','STS','SYRG','SYN','TRX','TGB','TAS','TIK','TGC','GLU','LGL','TXMD','TPI','TLR','TGD','TOF','TMP','TAT','TRXC','TPLM','TPHS','TRT','HTM','UFAB','UAMY','UUU','UQM','URG','URZ','UEC','VTG','VSR','VII','VHC','VGZ','VNRX','VISI','EAD','ERC','ERH','SBI','WRN','WYY','WTT','XTNT','BONE','YUMA','YUMA-PA','ZBB','ZBB.A','VFL.A','XXII.A','WIL.A','JRS.A','YUMA.A','XPL.A','VTG.A','XRA.A','UTG.A','VMM.A','QRM.A','YUMA-PA.A','VNRX.A','VHC.A','YGRO.A','FLWS','SRCE','VNET','TWOU','JOBS','CAFD','EGHT','AMRK','SHLM','AAON','ABAX','ABGB','ABY','ABMD','ACTG','ACHC','ACAD','ARAY','ACET','ACHN','ACIW','ACRS','ACOR','ACTS','ATVI','ACTA','ACXM','ADAP','ADUS','ADBE','ADTN','ADRO','AAAP','AEIS','ADVS','AEGR','AEGN','AEPI','AVAV','AFFX','AGYS','AGIO','AGFSW','AGFS','AIMT','AIRM','ATSG','AMCN','AIXG','AKAM','AKRX','ALRM','ALSK','AMRI','ABDC','ALXN','ALCO','ALGN','ALKS','ALGT','AHGP','ARLP','ALLT','MDRX','AFAM','ALNY','AOSL','GOOG','GOOGL','ATEC','ALTR','ASPS','AIMC','AMAG','AYA','AMZN','AMBCW','AMBC','AMBA','EPAX','AMCX','DOX','AMED','UHAL','ATAX','AMOV','CRMT','AAL','AGNC','AGNCP','MTGEP','MTGE','ACSF','ACAS','AMNB','ANAT','APEI','ARII','ARCPP','AMRB','ASEI','AMSWA','AMSC','AMWD','ABCB','AMSF','AMGN','AMKR','AMPH','AMSGP','AMSG','ASYS','AFSI','AMRS','ADI','ALOG','ABCW','ANGI','ANGO','ANIK','ANSS','APIC','APOG','APOL','AINV','AAPL','AMAT','AMCC','AREX','ARCB','ACGL','APLP','ACAT','ARNA','ARCC','AGIIL','AGII','ARIA','ARMH','ARRS','AROW','ARWR','ARTNA','ARUN','ASNA','ASND','ASCMA','ASMI','ASML','AZPN','ASFI','ASTE','ATRO','ATRA','ATHN','ACBI','ATNI','ATLC','AAWW','TEAM','ATML','ATRI','LIFE','ADNC','AUDC','ADSK','ADP','AVHI','AVGO','AVNU','AVEO','AVNW','AVID','CAR','ACLS','AXTI','BCOM','BEAV','BIDU','BCPC','BANFP','BANF','BKMU','OZRK','BFIN','BANR','BZUN','BBSI','BSET','BV','BBCN','BECN','BEBE','BBBY','BELFB','BELFA','BNCL','BGCP','BGFV','BIND','BRLI','TECH','BCRX','BIIB','BMRN','BIOS','BOTA','BEAT','BITI','BJRI','BBOX','BDE','BLKB','BBRY','HAWK','BKCC','BLMN','BCOR','BUFF','BHBK','NILE','BLUE','BPMC','STCK','BOBE','BOFI','WIFI','BOJA','BOKF','BONT','BONA','BAMM','BRDR','BPFHW','BPFH','BPFHP','EPAY','BDBD','BBRG','BBEPP','BBEP','BDGE','BBNK','BCOV','BRCM','BSFT','BRCD','BRKL','BRKS','BRKR','BMTC','BWLD','BLDR','CFFI','CA','CCMP','CDNS','CACQ','CZR','CSTE','PRSS','CALM','CLMS','CHY','CHI','CCD','CHW','CGO','CSQ','CAMP','CVGW','CALA','CLMT','CAC','CSIQ','CBNJ','CPLA','CBF','CCBG','CPLP','CSWC','CPTA','CFFN','CFNL','CSII','CATM','CECO','CTRE','CKEC','CRZO','TAST','CWST','CASY','CASS','CTRX','CATY','CATYW','CVCO','CAVM','CBOE','CDK','CDW','CECE','CELG','CLDX','CEMP','CSFL','CETV','CENTA','CENT','CENX','CNBKA','CPHD','CRNT','CERN','CEVA','CHRW','CYOU','CTHR','GTLS','CHTR','CHKP','CHFC','CCXI','CHMG','CHKE','CHMA','CBPO','JRJC','CHOP','CNIT','HTHT','CSUN','CNTF','CCIH','CHDN','CHUY','CMPR','CINF','CTAS','CRUS','CSCO','CTRN','CTXS','CHCO','CLNE','CKSW','CSBK','CLVS','CMFN','CME','CCNE','CISG','CNV','COBZ','COKE','CDXS','CCOI','CGNX','CTSH','COHR','COHU','COLL','CIGI','COLB','COLM','CMCO','CMCSA','CMCSK','CBSH','CVGI','COMM','CSAL','CTBI','CVLT','CPSI','CTG','SCOR','CMTL','CXRX','CNMD','CTWS','CNOB','CONN','CNSL','CWCO','CTCT','CTRL','CPRT','CORE','CSOD','CRVL','CSGP','COST','CRRC','CVTI','COVS','COWN','CRAI','CBRL','BREW','CRAY','CACC','CREE','CRESY','CRTO','CROX','CCRN','CRWN','CSGS','CCLP','CSRE','CSX','CTCM','CTRP','CPIX','CMLS','CUTR','CVBF','CYBR','CYBX','CYNO','CY','CONE','CYTK','CTMX','DSKY','DAKT','DTLK','PLAY','DWSN','DBVT','TRAK','DFRG','DGAS','XRAY','DEPO','DERM','DEST','DXLG','DXM','DXCM','DHXM','DMND','DHIL','FANG','DCIX','DRNA','DGII','DMRC','DCOM','DMTX','DIOD','DTV','DISCA','DISCB','DISCK','DISH','DLTR','DGICA','DGICB','DMLP','DORM','DWA','DSPG','DTSI','DLTH','DNKN','DXPE','BOOM','ETFC','EGLE','EROC','ELNK','EWBC','EVBS','EBAY','EBIX','ELON','ECHO','SATS','EDGE','EHTH','LOCO','EMITF','ESLT','ERI','ELRC','ESIO','EA','EFII','RDEN','LONG','EMCI','EMMS','EMMSP','ENTA','ECPG','WIRE','ENDP','ECYT','ELGX','EIGI','ERII','EXXI','ENOC','ESGR','ENTG','EBTC','EFSC','ENVI','ENZY','EPIQ','EPZM','PLUS','EQIX','ERIC','ERIE','ESSA','ESND','ETSY','EEFT','EVEP','EVLV','EXAC','EXEL','EXFO','EXLS','EXPE','EXPD','EXPO','ESRX','EXLP','EXTR','EZCH','EZPW','FFIV','FB','FCS','DAVE','FARM','FFKT','FARO','FAST','FBRC','FDML','FEIC','GSM','FGEN','LION','FDUS','FRGI','FSAM','FSC','FSCFL','FSFR','FITB','FITBI','FNGN','FISI','FNSR','FINL','FEYE','FBNC','BUSE','FBIZ','FCFS','FCNCA','FCBC','FBNK','FDEF','FFBCW','FFBC','FFIN','THFF','FFNW','FIBK','FRME','FMBI','FNBC','FNFG','FSLR','FSBK','FUNC','SVVC','FMER','FSRV','FSV','FISV','FIVE','FPRX','FLXS','FLEX','FLIR','FLDM','FFIC','FOGO','FORM','FORTY','FORR','FTNT','FWRD','FWP','FOSL','FMI','FXCB','FOXF','FRAN','FELE','FRED','RAIL','FTR','FRPH','FTD','FSYS','FTEK','FULT','FXEN','FXENP','GIII','GK','GLPG','GLPI','GRMN','GARS','GNCMA','GHDX','GNTX','THRM','GEOS','GERN','ROCK','GILT','GILD','GBCI','GLADO','GLAD','GOODN','GOODP','GOOD','GAINN','GAIN','GBT','GBLI','GSOL','GLUU','GOGO','GLNG','GMLP','GOGL','GBDC','GPRO','GMAN','LOPE','GLDD','GSBC','GNBC','GPRE','GLRE','GRFS','GRPN','OMAB','GSIG','GSIT','GBNK','GIFI','GURE','GPOR','HEES','HALO','HMPR','HBHCL','HBHC','HAFC','HQCL','HDNG','HLIT','HAS','HA','HCOM','HWKN','HWBK','HAYN','HDS','HCSG','HQY','HSTM','HWAY','HTLD','HTLF','HTWR','HSII','HELE','HSIC','HTBK','HFWA','HBOS','HCCI','MLHR','HIBB','HIMX','HMSY','HOLI','HOLX','HBCP','HOMB','AWAY','HMIN','HMST','HTBI','HKTV','HOFT','HBNC','HZNP','HRZN','ZINC','HDP','HMHC','HWCC','HSNI','HUBG','HCBK','HSON','HBANP','HBAN','HURC','HURN','HTCH','IACI','IBKC','IEP','ICLR','ICON','ICUI','IDXX','IGTE','IRG','IIVI','KANG','ILMN','IMMR','IMGN','IPXL','INCR','INCY','INDB','IBCP','IBTX','INFN','INFI','IPCC','INFA','IMKTA','INWK','IPHS','IOSP','ISSC','INGN','INOV','INO','NSIT','PODD','IART','IDTI','ISSI','INTC','IPAR','IBKR','ININ','ICPT','IDCC','TILE','INAP','IBOC','ISCA','IGLD','IIJI','ISIL','IILG','INTL','INTLL','ITCI','INTU','ISRG','SNAK','ISBC','ITIC','IONS','IPAS','IPCM','IPGP','IRDM','IRBT','IRWD','ISIS','ISLE','ITRI','ITRN','XXIA','IXYS','JJSF','JCOM','JASO','JKHY','JACK','JAKK','JRVR','JAZZ','JBHT','JD','JBLU','DATE','JST','JIVE','JBSS','JOUT','JNP','JUNO','KTWO','KALU','KMDA','KNDI','KPTI','KCAP','KRNY','KELYB','KELYA','GMCR','KFRC','KE','KBAL','KIRK','KITE','KLAC','KLXI','KFX','KZ','KOPN','KRNT','KRFT','KTOS','KLIC','KURA','KVHI','KYTH','LBAI','LKFN','LRCX','LAMR','LANC','LNDC','LSTR','LSCC','LAWS','LAYN','FSTR','LDRH','LGCYP','LGCY','LGCYO','LTXB','TREE','LXRX','LGIH','LHCG','LBRDK','LBRDA','LBTYB','LBTYA','LBTYK','QVCB','QVCA','LILAK','LILA','LMCK','LMCB','LMCA','TAX','LTRPA','LTRPB','LVNTA','LVNTB','LPNT','LCUT','LLNW','LMNR','LINC','LECO','LLTC','LNCO','LINE','LIOX','LQDT','LFUS','LIVN','LOB','LPSN','LKQ','LMIA','LOGI','LOGM','LOJN','LORL','LPLA','LYTS','LULU','LMNS','LITE','LMNX','LMOS','MTSI','MCBC','MGNX','MGLN','MGIC','MHLDO','MHLD','MSFG','MMYT','MANH','MTEX','MANT','MCHX','MKTX','MKTO','MRKT','MRLN','MAR','MRTN','MMLP','MRVL','MASI','MTCH','MTLS','MTRX','MAT','MATW','MFRM','MTSN','MXIM','MXWL','MBFI','MBTF','MCGC','MGRC','MDCA','MCOX','TAXI','MDAS','MDSO','MDVN','MPEL','MLNX','MEMP','MRD','MENT','MELI','MBWM','MERC','MBVT','MRCY','MRGE','EBSB','VIVO','MMSI','MLAB','MESO','CASH','MEOH','METR','MGEE','MGPI','MCRL','MCHP','MU','MSCC','MSFT','MSTR','MCEP','MIDD','MSEX','MOFG','MIME','MIND','MITL','MKSI','MINI','MOBL','MLNK','MOLG','MNTA','MOMO','MCRI','MDLZ','MGI','MPWR','TYPE','MNRO','MRCC','MNST','MORN','MOSY','MPAA','MDM','MTSC','LABL','MFLX','MYL','MYOK','MYRG','MYGN','NBRV','NANO','NK','NSSC','NDAQ','NTRA','NATH','FIZZ','NCMI','NCOM','NATI','NATL','NPBC','NRCIB','NRCIA','NWLI','BABY','NAVI','NAVG','NBTB','NCIT','NKTR','NEOG','UEPS','NTAP','NTES','NFLX','NTGR','NTCT','NBIX','NYMTP','NYMTO','NYMT','NBBC','NEWP','NWS','NWSA','NEWS','NXST','EGOV','NICE','NICK','NIHD','NNBR','NDLS','NDSN','NTK','NTRSP','NTRS','NFBK','NRIM','NWBI','NWPX','NCLH','NVMI','MIFI','NVAX','NVCR','NTLS','NUAN','NMRX','NUTR','NTRI','NUVA','QQQX','NVDA','NXPI','NXTM','ORLY','OIIM','ORIG','OCFC','OCLR','ODP','OFS','OHAI','ODFL','ONB','OSBC','OSBCP','ZEUS','OMCL','OVTI','ON','OMED','ONTX','ONTY','OTEX','OPHT','OPB','OSUR','ORBC','ORBK','OREX','SEED','ORIT','OFIX','OSIS','OTIC','OTTR','OUTR','OXLCN','OXLCP','OXLC','OXLCO','PCAR','PACB','PCBK','PMBC','PPBI','PSUN','PCRX','PACW','PTIE','PAAS','PNRA','PZZA','FRSH','PRXL','PSTB','PKOH','PTNR','PATK','PATI','PEGI','PDCO','PTEN','PAYX','PCTY','PYPL','PCCC','PCTI','PDCE','PDFS','PDLI','PGC','PEGA','PCO','PENN','PFLT','PNNT','PWOD','PTXP','PBCT','PEBO','PFIS','PWRD','PRFT','PFMT','PSEM','PERI','PERY','PETS','PCYC','PHII','PHIIK','PHMD','PLAB','PICO','PPC','PNK','PNFP','PLXS','PMCS','PMFG','PLCM','POOL','PLKI','BPOP','PTLA','PBPB','PCH','POWL','POWI','POZN','PRAA','PRAH','PFBC','PLPC','PINC','PRGX','PSMT','PRIM','PVTB','PKT','PGNX','PRGS','PSEC','PRTA','PRSC','PROV','PTC','PTCT','PULB','QADB','QADA','QGEN','QIWI','QLIK','QLGC','QLTI','QRVO','QCOM','QSII','QLYS','QDEL','QNST','QUMU','RRD','RSYS','RDWR','RMBS','GOLD','RAVN','ROLL','RLOC','RELY','RNWK','RP','RCPT','RRGB','REGN','RGNX','REIS','RELV','RLYP','REMY','RNST','REGI','RCII','RENT','RGEN','RJET','RBCAA','REXI','RECN','ROIC','SALE','REXX','RELL','RIGL','NAME','RNET','RVSB','FUEL','RCKY','RSTI','ROSE','ROST','ROVI','RGLD','RPXC','RRM','RTIX','RBCN','RUSHB','RUSHA','RUTH','RYAAY','STBA','SBRAP','SBRA','SABR','SAFT','SGNT','SAIA','SAFM','SNDK','SASR','SGMO','SANM','SRPT','SBAC','SCSC','SCHN','SCHL','SCLN','SGMS','SQI','SEAC','SBCF','STX','SRSC','SHLD','SHLDW','SPNE','SGEN','SEIC','SCSS','SIGI','SMTC','SENEA','SENEB','SQNM','MCRB','SREV','SFBS','SFXE','GAME','SHEN','SHLO','SHPG','SCVL','SHBI','SHOR','SFLY','SIEN','BSRR','SWIR','SIFY','SIGM','SIAL','SBNYW','SBNY','SLGN','SILC','SGI','SLAB','SIMO','SPIL','SSRI','SFNC','SINA','SBGI','SVA','SIRI','SIRO','SZMK','SKUL','SKYW','SWKS','SLM','SLMBP','SWHC','SMSI','LNCE','SODA','SOHU','SLRC','SUNS','SCTY','SEDG','SZYM','SONC','SONS','SSB','SBSI','OKSB','SP','SPKE','ONCE','SPAR','SPTN','SPPI','SAVE','SPLK','SPOK','SPWH','FUND','SFM','SPSC','SQBK','SSNC','STMP','STLY','SPLS','SBLK','SBLKL','SBUX','STRZA','STRZB','STFC','SNC','GASS','STLD','SMRT','STNR','SRCL','SRCLP','STRL','SHOO','BANX','SGBK','SSYS','STRS','STRA','SBBP','STB','SUBK','SNBC','SNHY','SEMI','STKL','SPWR','RUN','SMCI','SPRT','SGRY','SCAI','SRDX','SUSQ','SUTR','SIVBO','SIVB','SYKE','SYMC','GEVA','SYNA','SNCR','SGYP','ELOS','SNPS','SYNT','SYUT','TMUS','TMUSP','TROW','TTWO','TNGO','TEDU','TRGT','TASR','TCPC','AMTD','TECD','TECU','TSYS','TNAV','TTEC','TLGT','GLBL','TERP','TBNK','TSRO','TESO','TSLA','TESS','TSRA','TTEK','TTPH','TCBIL','TCBI','TCBIP','TCBIW','TXN','TXRH','TFSL','ABCO','ANDE','TBBK','BKYF','CG','CAKE','CHEF','PLCE','DSGX','ENSG','XONE','FNLC','TFM','GT','HCKT','HAIN','KEYW','KHC','MDCO','MIK','PCLN','SPNC','ULTI','WEN','YORW','NCTY','THRX','TCRD','THOR','TICC','TTS','TITN','TIVO','TOPS','TSEM','TW','TOWN','TSCO','TGA','TZOO','TRVN','TCBK','TRS','TRMB','TRIB','TRIP','TSC','TBK','TRIV','TRUE','TRST','TRMK','TTMI','TUBE','TUES','FOXA','FOX','TWIN','PRTS','UBIC','UBNT','ULTA','UCTT','RARE','ULTR','UTEK','UMBF','UMPQ','UBSH','QURE','UBSI','UCBI','UCFC','UDF','UBNK','UFCS','UNFI','UNTD','UBFO','USLM','USTR','UTHR','OLED','UEIC','UFPI','USAP','UACL','UVSP','UPIP','URBN','ECOL','USAK','UTMD','UTIW','UTSI','VNR','VNRCP','VNRAP','VNRBP','VRNS','VASC','WOOF','VECO','VRA','ARCP','VRNT','VRSN','VRSK','VSAR','VRTX','VRTB','VIAB','VIA','VSAT','VIAV','VIAVV','VICL','VICR','VDTH','VIEW','VLGEA','VIP','VNOM','VA','VIRT','VRTS','VRTU','VISN','VTL','VVUS','VOD','VOXX','VYGR','VSEC','VWR','WBA','WRES','WAFD','WAFDW','WASH','WSBF','WDFC','WWWW','WEB','WBMD','WB','WERN','WSBC','WTBA','WSTC','WMAR','WABC','WSTL','WDC','WFD','WPRT','WEYS','WHF','WHFBL','WFM','WILN','WIBC','WIN','WING','WTFC','WTFCM','WTFCW','WETF','WIX','WWD','WRLD','WPPGY','TRNX','WMGI','WSFSL','WSFS','WYNN','XBIT','XCRA','XNPT','XLNX','XOOM','XNET','YHOO','YNDX','YDLE','YRCW','YY','ZFGN','ZAGG','ZBRA','ZLTQ','ZAVVV','Z','ZG','ZCVVV','ZIONZ','ZION','ZIONW','ZIXI','ZU','ZUMZ','ZNGA','VSCI']
extra_tickers = []
for new in new_tickers:
	if new not in ticker_list:
		extra_tickers.append(new)
extra_tickers.sort()
# take only ase and nms from the other ticker list


def makeSoup(url):
	return BeautifulSoup(requests.get(url).text, "lxml")



# should use API for everything possible
def get_data(ticker):
	summary_url = "https://finance.yahoo.com/quote/" + ticker
	profile_url = summary_url + "/profile"

	stock = Share(ticker)

	summary_soup = makeSoup(summary_url)
	profile_soup = makeSoup(profile_url)

	try:
		first_split = summary_soup.prettify().split('recommendationMean',1)[1]
		if first_split[:5] == '":{}}':
			recommendation = "none"
		else:
			second_split = first_split.split(',"fmt":"',1)[1]
			recommendation = second_split.split('"}',1)[0]
	except IndexError:
		recommendation = "index_error"

	# the reactid approach may not be robust -
	# the market cap reactid has already been found to differ between stocks

	price = stock.get_price()
	market_cap = stock.get_market_cap()
	# industry = profile_soup.find("strong", {"data-reactid": "26"}).text
	try:
		industry = profile_soup.prettify().split('"industry":"',1)[1]
		industry = industry.split('"',1)[0]
	except IndexError:
		industry = "index_error"

	try:
		sector = profile_soup.prettify().split('"sector":"',1)[1]
		sector = sector.split('"',1)[0]
	except IndexError:
		sector = "index_error"
	# sector = profile_soup.find("strong", {"data-reactid": "22"}).text

	data = [ticker, sector, industry, price, market_cap, recommendation]
	for i in range(len(data)):
		try:
			data[i] = data[i].encode('utf-8')
		# this will catch if the ticker doesn't exist on yahoo
		except AttributeError:
			pass
	print data
	return data

# going to see if it's faster to collect all the data THEN print it all at once
# is there a RAM risk here?
# tried it. just doesn't seem faster. chillin


def put_data(data):
	with open('yahoo_finance_extras.csv', 'a') as csvfile:
		spamwriter = csv.writer(csvfile, delimiter=' ')#,quotechar='|', quoting=csv.QUOTE_MINIMAL)
		spamwriter.writerow(data)



with open('yahoo_finance_extras.csv', 'wb') as csvfile:
	spamwriter = csv.writer(csvfile, delimiter=' ')#,quotechar='|', quoting=csv.QUOTE_MINIMAL)
	spamwriter.writerow(['ticker','sector','industry','price',
						 'market_cap','recommendation'])



for ticker in extra_tickers:
	try:
		data = get_data(ticker)
	except:
		data = ["server error","","","","","server error"]
	put_data(data)